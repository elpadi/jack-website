define(["jquery","underscore","lib/ui/interface/Easing"],function(jquery,underscore,Easing){function Carousel($container){this.$container=$container;this.$elementsContainer=$container.find(".carousel__elements-container");this.width=$container.width();this.$elements=$container.find(".carousel__element");this.fetchPositions();this.onScrollFinish(0)}Carousel.prototype=$.extend({},Easing);Carousel.prototype.nextScroll=0;Carousel.prototype.width=0;Carousel.prototype.easing="swing";Carousel.prototype.duration=300;Carousel.prototype.fetchPositions=function(){this.positions=_.map(this.$elements,function(el,i){return{index:i,left:el.offsetLeft,top:el.offsetTop}})};Carousel.prototype.frontToBack=function(scrollLeft){var indexes=_.pluck(_.filter(this.positions,function(pos){return pos.left<scrollLeft&&pos.top===0}),"index");indexes.length>0&&this.$elements.slice(indexes[0],indexes.length).appendTo(this.$elementsContainer)};Carousel.prototype.setElementsDisplay=function(){var _this=this;_.each(this.positions,function(pos){_this.$elements[pos.index].style.visibility=pos.top===0?"visible":"hidden"})};Carousel.prototype.resetUI=function(scrollLeft){this.frontToBack(scrollLeft);this.$container.scrollLeft(0);this.$elements=this.$container.find(".carousel__element");this.fetchPositions();this.setElementsDisplay()};Carousel.prototype.getNextScroll=function(){var _this=this;return _.last(_.filter(this.positions,function(pos){return pos.left<_this.width&&pos.top===0})).left};Carousel.prototype.onScrollFinish=function(currentValue){this.resetUI(currentValue);this.nextScroll=this.getNextScroll()};Carousel.prototype.getCurrentScroll=function(){};Carousel.prototype.scrollTo=function(value){var _this=this;this.$container.animate({scrollLeft:value},this.duration,this.easing,function(){_this.onScrollFinish(value)})};Carousel.prototype.scrollRight=function(){this.scrollTo(this.nextScroll)};return Carousel});